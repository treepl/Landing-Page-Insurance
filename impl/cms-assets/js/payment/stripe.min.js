'use strict';(function(){function g(){function d(a,c,d,e){if("CreditCard"===c){if(!l)throw Error("Missing stripe key");a.style.display="block";a.dataset.paymentEnabled=!0;d.mount(`#paymentFields_${e}`)}else a.style.display="none",d.unmount(`#paymentFields_${e}`),a.dataset.paymentEnabled=!1}var c=document.forms;let k=document.scripts,l="",f=[];var a=window.paymentGatewaySettings;let g={style:{base:{backgroundColor:a?a.style.backgroundColor:"",color:a?a.style.color:"#32325d",fontSmoothing:a?a.style.fontSmoothing:
"antialiased",fontSize:a?a.style.fontSize:"16px",lineHeight:a?a.style.lineHeight:"16px","::placeholder":{color:a?a.style.placeholderColor:"#444"},iconColor:a?a.style.iconColor:"#32325d"},invalid:{color:a?a.style.invalidColor:"#fa755a",iconColor:a?a.style.invalidIconColor:"#fa755a"}},hideIcon:a?a.hideIcon:!1,iconStyle:a?a.iconStyle:"default",hidePostalCode:a?a.hidePostalCode:!0};for(a=0;a<c.length;a++)if(c[a].elements.Payment_Data){let h=c[a];var e=h.getAttribute("name");let d=`${e}_${a}`,g=document.getElementById(`paymentFields_${e}`);
e=document.getElementById(`paymentErrors_${e}`);g.id=`paymentFields_${d}`;e.id=`paymentErrors_${d}`;h.setAttribute("name",d);f.push(c[a])}for(c=0;c<k.length;c++)if(-1!==k[c].src.indexOf("/cms-assets/js/payment/stripe.min.js")){l=q(k[c].src,"key");break}f&&f.forEach((a)=>{function c(a){return f.createPaymentMethod({type:"card",card:m,billing_details:{email:a.elements.Email.value}}).then(function(b){return b.error?(document.getElementById(`paymentErrors_${n}`).textContent=b.error.message,a.dataset.form_submitted=
!1):b.paymentMethod})}function e(b){b&&(a.elements.Payment_Data.value=b.id,fetch(a.action,{method:"POST",body:new FormData(a)}).then(function(a){return a.json()}).then(function(a){a.Link?window.location=`${location.origin}${a.Link}`:"RequiresAction"===a.PaymentState&&k(a.PaymentIntentClientSecret,b.id)}))}function k(b,c){return f.confirmCardPayment(b,{payment_method:c,return_url:`${location.origin}/checkout-response`},{handleActions:!1}).then(function(b){if("requires_action"===b.paymentIntent.status)(b=
b.paymentIntent.next_action)&&"redirect_to_url"===b.type&&(window.location=b.redirect_to_url.url);else if("succeeded"===b.paymentIntent.status||"requires_capture"===b.paymentIntent.status)window.location=`${location.origin}/checkout-response?payment_intent=${b.paymentIntent.id}&payment_intent_client_secret=${b.paymentIntent.client_secret}&source_type=${b.paymentIntent.payment_method_types[0]}`;else if(b.error)return document.getElementById("paymentErrors_stripe3DSecureForm").textContent=b.error.message,
a.dataset.form_submitted=!1})}let f=Stripe(l);var p=f.elements();let n=a.getAttribute("name"),m=p.create("card",g),h=document.getElementById(`paymentFields_${n}`);p=a["g-recaptcha-response-v3"]?"customFormSubmit":"submit";a.dataset.form_submitted=!1;d(h,a.elements.Payment_Type.value,m,n);a.elements.Payment_Type.onchange=function(b){b.preventDefault();d(h,b.target.value,m,a.name)};a.addEventListener(p,function(b){b.preventDefault();b=b.target;"true"!==b.dataset.form_submitted?(b.dataset.form_submitted=
!0,"CreditCard"===b.elements.Payment_Type.value?c(b).then(e):a.submit()):alert("Form submission is in progress.")})})}function q(d,c){d=new URL(d);return(new URLSearchParams(d.search)).get(c)}document.addEventListener("DOMContentLoaded",function(d){g()})})();
