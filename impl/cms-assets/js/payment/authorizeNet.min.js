'use strict';(function(){function l(){function c(b,d){"CreditCard"===d?(b.style.display="block",b.dataset.paymentEnabled=!0):(b.style.display="none",b.dataset.paymentEnabled=!1)}let e=document.forms,g=[],f=null,k=null;for(let b=0;b<e.length;b++)if(e[b].elements.Payment_Data){let d=e[b];var h=d.getAttribute("name");let c=`${h}_${b}`,f=document.getElementById(`paymentFields_${h}`);h=document.getElementById(`paymentErrors_${h}`);f.id=`paymentFields_${c}`;h.id=`paymentErrors_${c}`;d.setAttribute("name",
c);g.push(e[b])}g&&(g.forEach((b,d)=>{function e(a){a=a.form;if("CreditCard"===a.elements.Payment_Type.value&&""===a.Payment_Data.value)return f=a,k.click(),!1;h(a)}function h(a){null===m(a.action,"jsonResponse")&&(a.action+=n(a.action)?"&":"?",a.action+="jsonResponse=1");fetch(a.action,{method:"POST",body:new FormData(a)}).then(function(a){return a.json()}).then(function(c){if(c.Error&&0!=c.Error)alert(c.ErrorMessages.join("\r\n")),a.dataset.form_submitted=!1;else if(c.FormRedirectLink&&""!==c.FormRedirectLink){let d=
"SuccessPage";"Paypal"===b.elements.Payment_Type.value&&(d="PaymentRedirect");b.CMS_AfterFormPaymentHandled.data={FormRedirectLink:c.FormRedirectLink,LinkType:d,Response:c};a.dispatchEvent(a.CMS_AfterFormPaymentHandled)}})}d=b.getAttribute("name");null===k&&(k=b.elements.paymentButton);let g=document.getElementById(`paymentFields_${d}`);d=b["g-recaptcha-response-v3"]?"customFormSubmit":"submit";b.dataset.form_submitted=!1;c(g,b.elements.Payment_Type.value);b.elements.Payment_Type.onchange=function(a){a.preventDefault();
c(g,a.target.value)};b.addEventListener(d,function(a){a.preventDefault();a=a.target;if("true"!==a.dataset.form_submitted){b.CMS_AfterFormPaymentHandled=new Event("CMS_AfterFormPaymentHandled",{cancelable:!0});a.CMS_CustomSubmit||(b.CMS_CustomSubmit=new Event("CMS_CustomSubmit",{cancelable:!0}));a.dataset.form_submitted=!0;b.CMS_CustomSubmit.data={form:b};if("CreditCard"===a.elements.Payment_Type.value&&""===a.Payment_Data.value)return f=a,k.click(),!1;b.dispatchEvent(b.CMS_CustomSubmit)}else alert("Form submission is in progress.")});
b.addEventListener("CMS_CustomSubmit",function(a){a.defaultPrevented?a.data.form.dataset.form_submitted=!1:e(a.data)});b.addEventListener("CMS_triggerHandlePayment",function(a){if(a.data.response&&a.data.response.FormRedirectLink&&""!==a.data.response.FormRedirectLink){let c="SuccessPage";"Paypal"===b.elements.Payment_Type.value&&(c="PaymentRedirect");b.CMS_AfterFormPaymentHandled.data={FormRedirectLink:a.data.response.FormRedirectLink,LinkType:c,Response:a.data.response};a.data.submitData.form.dispatchEvent(a.data.submitData.form.CMS_AfterFormPaymentHandled)}else e(a.data.submitData)});
b.addEventListener("CMS_AfterFormPaymentHandled",function(a){a.defaultPrevented||(window.location=a.data.FormRedirectLink)});window.addEventListener("message",function(a){"CLOSE_IFRAME"==a.data.type&&(f.dataset.form_submitted=!1,f=null)})}),window[k.dataset.responsehandler]=function(b){if("Error"===b.messages.resultCode)for(var c=0;c<b.messages.message.length;c++)alert(b.messages.message[c].code+":"+b.messages.message[c].text);else f.elements.Payment_Data.value=b.opaqueData.dataValue,f.elements.Payment_Data_Descriptor.value=
b.opaqueData.dataDescriptor,f.CMS_CustomSubmit.data={form:f},f.dispatchEvent(f.CMS_CustomSubmit)})}function m(c,e){c=new URL(c);return(new URLSearchParams(c.search)).get(e)}function n(c){c=new URL(c);c=new URLSearchParams(c.search);let e=0;for(let g of c)e++;return e}document.addEventListener("DOMContentLoaded",function(c){setTimeout(()=>{l()},0)})})();
