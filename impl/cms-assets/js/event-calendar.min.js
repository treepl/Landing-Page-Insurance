'use strict';(function(m){m.createEventCalendarHolder=function(a,e,c){function f(a){b.classList.remove("md-size");b.classList.remove("sm-size");800>=a&&400<a?b.classList.add("md-size"):400>=a&&b.classList.add("sm-size")}let b=document.getElementById(a),k=b.parentElement.offsetWidth;var h="January February March April May June July August September October November December".split(" "),d=new Date;let l=d.getFullYear(),m=d.getMonth();d=`eventCalendar${d.getTime()}`;let g=`<calendar_loader class="calendar_treepl_loader"><svg class="spinner" width="65px" height="65px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg"><circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></calendar_loader><calendar_header class="calendar_treepl_header"><a href="javascript:" class="prev-month" onclick="goToEventCalendarPrevMonth('${d}', '${a}', ${e}, ${c})"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"/><path d="M0-.5h24v24H0z" fill="none"/></svg></a><div class="active_month"><div class="active_month_select"><select class="selectMonthDrop" onchange="createEventCalendar('${d}', '${a}', ${e}, ${c})">`;
800>=k&&400<k?b.classList.add("md-size"):400>=k&&b.classList.add("sm-size");for(var n=0;n<h.length;n++)g+=`<option value="${n}">${h[n]}</option>`;g+=`</select></div><div class="active_month_select"><select class="selectYearDrop" onchange="createEventCalendar('${d}', '${a}', ${e}, ${c})">`;for(h=0;20>h;h++)n=2017+h,g+=`<option value="${n}">${n}</option>`;b.innerHTML=g+`</select></div></div><a href="javascript:" class="next-month" onclick="goToEventCalendarNextMonth('${d}', '${a}', ${e}, ${c})"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"/><path d="M0-.25h24v24H0z" fill="none"/></svg></a></calendar_header><calendar_treepl_body class="calendar_treepl_body" id="${d}"></calendar_treepl_body><calendar_modal style="display: none;" class="calendar_treepl_modal"></calendar_modal>`;
b.getElementsByClassName("selectMonthDrop")[0].value=m;b.getElementsByClassName("selectYearDrop")[0].value=l;window.addEventListener("resize",()=>{k=b.parentElement.offsetWidth;f(k)});f(k);createEventCalendar(d,a,e,c)};m.openEventCalendarMobileModalWindow=function(a,e){var c=document.getElementById(e);if(400<c.parentElement.offsetWidth)return!1;c=c.getElementsByClassName("calendar_treepl_modal")[0];var f=a.getElementsByClassName("calendar_table_event_holder")[0];a=new Date(+f.dataset.time);f=f.getElementsByTagName("a");
e=`<div class="calendar_treepl_modal_content"><div class="title-bar"><strong class="title">${a.toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric"})}</strong><a href="javascript:" class="close" onclick="closeEventCalendarMobileModalWindow('${e}')"><svg fill="#9c9c9c" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" /><path d="M0 0h24v24H0z" fill="none" /></svg></a></div><div class="modal-events-holder"><div class="modal-events-list">`;
for(let a of f)-1===a.className.indexOf("clear")&&(e+=`<div class="event"><a href="${a.getAttribute("href")}">${a.getAttribute("title")}</a></div>`);e+="</div></div></div>";c.innerHTML=e;c.style.display="block"};m.closeEventCalendarMobileModalWindow=function(a){a=document.getElementById(a).getElementsByClassName("calendar_treepl_modal")[0];a.style.display="none";a.innerHTML=""};m.goToEventCalendarPrevMonth=function(a,e,c,f){var b=document.getElementById(e);let k=b.getElementsByClassName("selectMonthDrop")[0];
b=b.getElementsByClassName("selectYearDrop")[0];let h=+k.value,d=+b.value,l=h-1;if(0==h&&2017==d)return!1;-1==l&&(l=11,--d);k.value=l;b.value=d;createEventCalendar(a,e,c,f)};m.goToEventCalendarNextMonth=function(a,e,c,f){var b=document.getElementById(e);let k=b.getElementsByClassName("selectMonthDrop")[0];b=b.getElementsByClassName("selectYearDrop")[0];let h=+k.value,d=+b.value,l=h+1;if(11==h&&d==+b.options[b.options.length-1].value)return!1;12==l&&(l=0,d+=1);k.value=l;b.value=d;createEventCalendar(a,
e,c,f)};m.createEventCalendar=function(a,e,c,f){function b(a){a=a.getDay();0==a&&(a=7);return a-1}let k=document.getElementById(a);a=document.getElementById(e);let h=a.getElementsByClassName("calendar_treepl_loader")[0];c=f?""!=a.dataset.group?0!=a.dataset.group?a.dataset.group:"":-1==a.dataset.event_group?"":a.dataset.event_group==c?-1:a.dataset.event_group:-1!=a.dataset.event_group?a.dataset.event_group:"";f=a.dataset.module_id;let d=encodeURIComponent(a.dataset.category||""),l=a.getElementsByClassName("selectMonthDrop")[0];
a=a.getElementsByClassName("selectYearDrop")[0];let m=+l.value;a=+a.value;let g=new Date(a,m),n=new Date;a=`?prop_ModuleId=${f}&prop_ongoingDate=${`${m+1}/1/${a}`}&prop_ParentId=${c}&prop_ItemCategories=${d}&jsonResponse=1`;let p='<div class="calendar_table"><div class="calendar_table_head"><div class="calendar_table_row"><div class="calendar_table_column">Mon</div><div class="calendar_table_column">Tue</div><div class="calendar_table_column">Wed</div><div class="calendar_table_column">Thu</div><div class="calendar_table_column">Fri</div><div class="calendar_table_column">Sat</div><div class="calendar_table_column">Sun</div></div></div><div class="calendar_table_body"><div class="calendar_table_row">';
c=new XMLHttpRequest;h.style.display="flex";for(f=0;f<b(g);f++)p+='<div class="calendar_table_column"><div class="calendar_table_date other-month"><span></span></div><div class="calendar_table_event_holder"></div></div>';c.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var a=JSON.parse(this.responseText).items;for(a=a.sort(function(a,d){return(new Date(a.EventDateStart)).getTime()-(new Date(d.EventDateStart)).getTime()});g.getMonth()==m;){var c="",d=g.getTime();n.getMonth()==
g.getMonth()&&n.getDate()==g.getDate()&&(c="today");p+=`<div class="calendar_table_column" onclick="openEventCalendarMobileModalWindow(this, '${e}');"><div class="calendar_table_date ${c}"><span>${g.getDate()}</span></div><div class="calendar_table_event_holder" data-time="${d}"></div></div>`;6==b(g)%7&&(p+='</div><div class="calendar_table_row">');g.setDate(g.getDate()+1)}if(0!=b(g))for(c=b(g);7>c;c++)p+='<div class="calendar_table_column"><div class="calendar_table_date other-month"><span></span></div><div class="calendar_table_event_holder"></div></div>';
p+="</div></div></div>";k.innerHTML=p;c=k.getElementsByClassName("calendar_table_row");for(let b of a){a=b.EventDateStart.split(/[^0-9]/);d=b.EventDateEnd.split(/[^0-9]/);a=(new Date(a[0],a[1]-1,a[2],a[3],a[4],a[5])).getTime();d=(new Date(d[0],d[1]-1,d[2],d[3],d[4],d[5])).getTime();for(let e of c){var f=e.getElementsByClassName("calendar_table_event_holder");let c=0,g="";for(let e of f)if(e.dataset.time){f=+e.dataset.time;var l=f+864E5-1;let k=e.innerHTML,h=e.getElementsByTagName("a").length+1;if(l>
a&&d>f){let a=l="";0==c&&(l=b.Name,g=h,c++);if(g>h)for(let b=0;b<g-h;b++)a+='<a class="calendar_table_event clear"></a>';e.innerHTML=k+a+`<a href="${b.Url}" title="${b.Name.replace(/"/gim,"&#34;")}" class="calendar_table_event"><span>${l}</span></a>`}if(d<f)break}}}h.style.display="none"}};c.open("GET",a,!0);c.send()}})(window);
